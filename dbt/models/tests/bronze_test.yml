version: 2

sources:
  - name: bronze
    schema: bronze
    tables:
      - name: webtoon_user_events_raw
        description: "Raw user events ingested from kafka (bronze layer)"
        columns:
          - name: event_id
            description: "Unique identifier per event"
            tests:
              - not_null
              - unique

          - name: user_id
            description: "User identifier"
            tests:
              - not_null

          - name: event_type
            description: "Type of user event"
            tests:
              - dbt_expectations.expect_column_values_to_be_in_set:
                  value_set: ["enter", "scroll", "complete", "exit"]

          - name: scroll_ratio
            description: "Scroll percentage (0.0 ~ 1.0)"
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0.0
                  max_value: 1.0

          - name: scroll_event_count
            descrption: "Number of scroll events per session"
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: datetime
            description: "Event date"
            tests:
              - not_null
              - dbt_expectations.expect_column_values_to_match_regex:
                  regex: "^(202[0-9]|2030)-[0-1][0-9]-[0-3][0-9]$"
