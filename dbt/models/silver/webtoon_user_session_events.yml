version: 2

sources:
  - name: silver
    schema: silver
    tables:
      - name: webtoon_user_session_events
        description: "Bronze to Silver ETL results (silver layer)"
        columns:
          - name: session_id
            description: "Session identifier"
            tests:
              - not_null

          - name: user_id
            description: "User identifier"
            tests:
              - not_null

          - name: webtoon_id
            description: "Identifier per webtoon"
            tests:
              - not_null

          - name: episode_id
            description: "Identifier per webtoon episode"
            tests:
              - not_null

          - name: datetime
            description: "Event date"
            tests:
              - not_null

          - name: platform
            description: ""
            tests:
              - not_null

          - name: country
            description: ""
            tests:
              - not_null

          - name: device
            description: ""
            tests:
              - not_null

          - name: browser
            description: ""
            tests:
              - not_null

          - name: duration_ms
            description: "Accumulative time while reading webtoon"
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0
                  max_value: 86400000

          - name: max_scroll_ratio
            description: "Accumulative scroll ratio while reading webtoon"
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0.0
                  max_value: 1.0

          - name: session_state
            description: "User session state"
            tests:
              - dbt_expectations.expect_column_values_to_be_in_set:
                  value_set: ["COMPLETE", "EXIT", "TIMEOUT_EXIT", "IN_PROGRESS"]
